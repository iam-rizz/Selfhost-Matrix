###############################################################################
#  Fail2ban Filter â€” Matrix Synapse Login Failures                            #
#  Matches failed login attempts in Synapse logs                              #
###############################################################################

[Definition]
failregex = ^.* Received request: POST /_matrix/client/.*/login.*$
            ^.*Failed password login.*remote_addr=<HOST>.*$
            ^.*Got login request.*<HOST>.*Credentials were refused.*$

ignoreregex =

# Note: Synapse must log with the real client IP (x_forwarded: true in homeserver.yaml)
# The log file path should point to Synapse's homeserver.log
