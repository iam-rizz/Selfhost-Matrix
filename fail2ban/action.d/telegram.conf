###############################################################################
#  Fail2ban Action â€” Telegram Notification                                    #
#  Sends ban/unban alerts via Telegram Bot API                                #
#  Requires: TELEGRAM_BOT_TOKEN and TELEGRAM_CHAT_ID in .env                  #
###############################################################################

[Definition]

# Bot token and chat ID â€” set these or use setup.sh to configure
# You can also set these directly here if not using setup.sh
norestored = true

actionstart = /usr/bin/curl -s -X POST \
    "https://api.telegram.org/bot__TELEGRAM_BOT_TOKEN__/sendMessage" \
    -d "chat_id=__TELEGRAM_CHAT_ID__" \
    -d "parse_mode=HTML" \
    -d "text=ðŸŸ¢ <b>Fail2ban:</b> Jail <code><name></code> started on <code>$(hostname)</code>"

actionstop = /usr/bin/curl -s -X POST \
    "https://api.telegram.org/bot__TELEGRAM_BOT_TOKEN__/sendMessage" \
    -d "chat_id=__TELEGRAM_CHAT_ID__" \
    -d "parse_mode=HTML" \
    -d "text=ðŸ”´ <b>Fail2ban:</b> Jail <code><name></code> stopped on <code>$(hostname)</code>"

actionban = /usr/bin/curl -s -X POST \
    "https://api.telegram.org/bot__TELEGRAM_BOT_TOKEN__/sendMessage" \
    -d "chat_id=__TELEGRAM_CHAT_ID__" \
    -d "parse_mode=HTML" \
    -d "text=ðŸš« <b>Fail2ban BAN</b>%0A<b>Jail:</b> <code><name></code>%0A<b>IP:</b> <code><ip></code>%0A<b>Host:</b> <code>$(hostname)</code>%0A<b>Time:</b> $(date '+%%Y-%%m-%%d %%H:%%M:%%S')"

actionunban = /usr/bin/curl -s -X POST \
    "https://api.telegram.org/bot__TELEGRAM_BOT_TOKEN__/sendMessage" \
    -d "chat_id=__TELEGRAM_CHAT_ID__" \
    -d "parse_mode=HTML" \
    -d "text=âœ… <b>Fail2ban UNBAN</b>%0A<b>Jail:</b> <code><name></code>%0A<b>IP:</b> <code><ip></code>%0A<b>Host:</b> <code>$(hostname)</code>"

[Init]
name = default
